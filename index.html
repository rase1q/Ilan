<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Мой сайт</title>

  <!-- Разводим виджеты по разным местам -->
  <style>
    /* Делаем все виджеты "поверх" страницы */
    iframe, .chatra--widget, .b24-widget-button-wrapper, .b24-widget-button-block,
    #jivo-iframe-container, .jivo_widget, #jivo_chat_widget, .jivo-btn {
      z-index: 2147483000 !important;
    }

    /* 1) Chatra: справа снизу */
    .chatra--widget {
      right: 16px !important;
      left: auto !important;
      bottom: 16px !important;
    }

    /* 2) Bitrix24: справа, выше Chatra */
    .b24-widget-button-wrapper,
    .b24-widget-button-block {
      right: 16px !important;
      left: auto !important;
      bottom: 96px !important;
    }

    /* 3) Jivo: слева снизу */
    #jivo-iframe-container,
    .jivo_widget,
    #jivo_chat_widget,
    .jivo-btn {
      left: 16px !important;
      right: auto !important;
      bottom: 16px !important;
    }

    /* 4) amoCRM: справа, ещё выше */
    iframe[src*="amocrm.ru"],
    iframe[id*="amo"],
    iframe[name*="amo"] {
      right: 16px !important;
      left: auto !important;
      bottom: 176px !important;
    }

    /* 5) Chat2Desk: слева, выше Jivo */
    iframe[src*="chat2desk"] {
      left: 16px !important;
      right: auto !important;
      bottom: 96px !important;
    }
  </style>

  <!-- Jivo Chat async -->
  <script src="//code.jivo.ru/widget/ChUC44vQkb" async></script>
</head>

<body>
  <h1>Привет!</h1>
  <p>Работает ✅</p>

  <script>
    document.addEventListener("DOMContentLoaded", function () {

      /* ========== 1) Chatra ========== */
      (function(d, w, c) {
        w.ChatraID = 'XPhAEAZMiuvKnbs8H';
        var s = d.createElement('script');
        w[c] = w[c] || function() {
          (w[c].q = w[c].q || []).push(arguments);
        };
        s.async = true;
        s.src = 'https://call.chatra.io/chatra.js';
        d.head.appendChild(s);
      })(document, window, 'Chatra');

      /* ========== 2) amoCRM online chat ========== */
      (function(a,m,o,c,r,m){
        a[m]={
          id:"439879",
          hash:"2f127fe277cc494cb7acc0fc955e5bb70935febdc215a0db8da9d7e0dbf2e76d",
          locale:"ru",
          inline:true,
          setMeta:function(p){
            this.params=(this.params||[]).concat([p])
          }
        };

        a[o]=a[o]||function(){
          (a[o].q=a[o].q||[]).push(arguments)
        };

        a[o+'Config']=a[o+'Config']||{};
        a[o+'Config'].hidden = false;

        var d=a.document, s=d.createElement('script');
        s.async=true;
        s.id=m+'_script';
        s.src='https://gso.amocrm.ru/js/button.js';
        d.head && d.head.appendChild(s);
      }(window,0,'amoSocialButton',0,0,'amo_social_button'));

      /* ========== 3) Bitrix24 widget ========== */
      (function(w,d,u){
        var s=d.createElement('script');
        s.async=true;
        s.src=u+'?'+(Date.now()/60000|0);
        var h=d.getElementsByTagName('script')[0] || d.body.firstChild;
        if (h && h.parentNode) h.parentNode.insertBefore(s,h);
        else d.body.appendChild(s);
      })(window,document,'https://cdn-ru.bitrix24.ru/b36252142/crm/site_button/loader_1_wt0mp1.js');

      /* ========== 4) Jivo Chat ========== */
      (function(d){
        var s = d.createElement("script");
        s.async = true;
        s.src = "//code.jivo.ru/widget/i0chOJB5IC";
        d.head.appendChild(s);
      })(document);

      /* ========== 5) Chat2Desk (новый код) ========== */
      (function(){
        // IE11 support
        var ie = document.createElement("script");
        ie.src = "https://livechatv2.chat2desk.com/packs/ie-11-support.js";
        ie.async = true;
        document.head.appendChild(ie);

        // Config
        window.chat24_token = "4b16380170d3ca2769baedc334df8a08";
        window.chat24_url = "https://livechatv2.chat2desk.com";
        window.chat24_socket_url = "wss://livechatv2.chat2desk.com/widget_ws_new";
        window.chat24_static_files_domain = "https://storage.chat2desk.com/";
        window.lang = "ru";

        // Load manifest and bundle
        fetch(window.chat24_url + "/packs/manifest.json?nocache=" + Date.now())
          .then(function(res){ return res.json(); })
          .then(function(data){
            var chat24 = document.createElement("script");
            chat24.type = "text/javascript";
            chat24.async = true;
            chat24.src = window.chat24_url + data["application.js"];
            document.body.appendChild(chat24);
          });
      })();

    });
  </script>
</body>
</html>
